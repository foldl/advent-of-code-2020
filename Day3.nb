(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16959,        348]
NotebookOptionsPosition[     15880,        319]
NotebookOutlinePosition[     16300,        336]
CellTagsIndexPosition[     16257,        333]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["1", "Section",
 CellChangeTimes->{{3.817071905144342*^9, 3.8170719182231984`*^9}, 
   3.817073448908798*^9},ExpressionUUID->"e7ff7d93-d355-41b5-83b6-\
78042f1ddb9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"input", "=", 
   RowBox[{
   "StringSplit", "[", 
    "\"\<.#..#....##...#....#.....#.#...\n........##....#..#..##....#.#..\n\
......##......##.........#....#\n...#.....#....##.......#.#....#\n\
.#.###.#.#..#.....##..#....#.#.\n##.........##.....####......#..\n\
#...#..........#.##............\n####............#..........#.#.\n\
......#......#....##...#..##...\n#..#....#...#......#......####.\n\
......#..........#.........#.#.\n...##.......#..#.#..#..#....#..\n\
..####....#.#...............##.\n...###........#.....#..........\n\
#..#.##...##.#..##...##...#....\n.###........#.##..#.#.....#....\n\
.#.......#..##.......#......#..\n.##...........#..............#.\n\
...#..#.....#...........#...#..\n.....#..............#..#.......\n\
.......#....#.....##...........\n.#...#.............#.....##....\n\
....#.#....#...#...#..#..##.#..\n...#..##..##...#..##........#.#\n\
.###..#...#.#.#.#..#...#.......\n.....##.#.##.#.#.......#..#....\n\
.##.#...#.....#...#....#.....#.\n.....#......###....###..##.#..#\n\
.....#..##....#..#.#..#.#.#....\n#....#.....#.#.......#...#....#\n\
...#........#............#..#..\n#.#...#...#..##.........#...##.\n\
.#..#.#...........#....#...#...\n##..#.#..........#.....###...#.\n\
#..#........#.......#.#..#....#\n..#...##....#..#....#....#.....\n\
...#.....##....#...#..#....##.#\n.....#......#...#.#.#.#.#......\n\
###.....#..#.#..........##.#...\n...............#..#...#.#....#.\n\
#.....#.....###....#..........#\n........#...#.#.......#..#...#.\n\
..#.##...#...#...#.........#...\n#..........#..#.#...........##.\n\
##.......#.#.#...#.....#.......\n...#.#.#.....#......#....##..#.\n\
##.#.....#....#...#.......#....\n.#......##..#.##.#....##..##.#.\n\
..#..#......#....#...#..#.#....\n...#..###...#.......#..#.......\n\
...#....#..#....#........##....\n#...#...#....#.#.........###.#.\n\
.#.........##..##...#..........\n...##.....##.........#..#..#...\n\
###....#......#.##..#...#......\n.###....#.#.......#..#....#...#\n\
....####........##....#.#....##\n..#.....#......##...#..#..#....\n\
...#....#...#......#.###.#.#.#.\n......#.......#..#...#...#.....\n\
.#...#...#..#.#..........#.....\n........#..#.........#.#....##.\n\
.#....#.......#........#.##.#..\n...#...#..#.....#......#...##..\n\
.#.................#........###\n.......#.#..#.#...#............\n\
.#.......#..##...#.###....#.##.\n#........#.###.#..#........##..\n\
..##.#....##......##........#..\n...............#...............\n\
#.......#......##..#.#....#.#.#\n..#.....#......#.#.#...#...##..\n\
..........#........#.....##...#\n#..........#.#..#..##..#......#\n\
.......#..###..##.#..##........\n#.#..##..###..#.###.....#.#..##\n\
..#.#........#...###...##......\n.......##.....##...#.##........\n\
.#.#...###..#..#......##....##.\n#...#.#.....##..#..#..#.#....#.\n\
........#......#....#..#.......\n...#.#.#.#........###....#...#.\n\
.#......#...#.......#......#...\n#...#.##.#..#.#..#.........#...\n\
....#......##......#........#.#\n..##.#.....#..#......#..#......\n\
#.##...##...#................#.\n.....#..#....#....#####........\n\
....#..#..#.#...#.#............\n.........#.#....#..#....##...#.\n\
#....#..........#......#......#\n.......#..............#......#.\n\
.#..#...#..#.#.....#.#.#.##.#..\n.##........#......#...#.##.....\n\
...#.##..#........#...........#\n..#...#..#........#.......#.#..\n\
#.....#..#.#..#..#...#...#..#..\n..................#.#.....#...#\n\
........#...##.#..#.........#..\n.#...##.#...........##.##...#..\n\
#......#.........#...#...#...#.\n..........#.............#...#..\n\
#............##.#..#...#.#...#.\n..#.##...##....##.#...####...#.\n\
#.##..#......#.......#.#...##..\n.....#...#..#......#####.##..#.\n\
#...#.#.##..#..##.....#......#.\n.#..#......#.#.#...#.#...##.#..\n\
.#.....#..##........#.....#...#\n.................#..........#..\n\
##.#.#......#.####..#.....#....\n.#...##.####..#...#............\n\
..#...............###....#....#\n#...#..###..#.#.##...........##\n\
...................#..#.....#..\n...#.##.#...#.....#......#.##..\n\
#.#...#.........##.#........#.#\n.##.......#..#..#.....##....#..\n\
......##.#.#..#...#.#..##.....#\n..#..###...#...#......#.#......\n\
..##....#.#...#....#....#..#..#\n#..##....#........#..##..#..#.#\n\
.......#............#....##..#.\n.#.#..#.........#.#.##......#..\n\
#.#....#..##..#..###.#.....##..\n.###.#......#.....#####...#....\n\
#...#.#...##......#...#.#...##.\n#..#.........#..#............#.\n\
...##......##.......##....##...\n...#...##....###..###.#...#....\n\
#.#....#...#.#...##..#........#\n.#..#..................#....#..\n\
#......#..#...##..##...#..##..#\n...#..#.....#...#........#.#.#.\n\
#...#..##....#.....#........#..\n.##..#....#.....#.#............\n\
##..##.#.#.##.#.#..#.#..#....#.\n#.......#...............#.....#\n\
..#.....#..##.....#...##.##....\n...#..#...#.#.#....#......#....\n\
###.#.......#....#....#.#...#..\n.....###..#...###.#.#..#.......\n\
.....#.........##.#....#..##.#.\n........#....#....#....#.#..##.\n\
........###....#.#.........#.#.\n.#..###..#........#.......##.#.\n\
.#.#...........................\n..#....##...#.#....#....#.#....\n\
.#...#...##.#........###....#..\n#.#....#...#.#.#...##......##..\n\
#......#....#...#..#....#...#..\n...#..##........#.#...##......#\n\
....##...........##...#..#..#..\n......#..#........#..#....##.##\n\
.###..#.#.........#.....#......\n.#..##............#......#.....\n\
..##.#.#..#..#.###....#..#..#..\n....#.#..#.#..##...##.#.#.#.#..\n\
....#..#....#...............#..\n..#...#.##.....##....#..##..#..\n\
.......##.#....#.##....#.......\n.#...#........#...#......#.###.\n\
..#....##.......#....#.#...#.#.\n.....#.....#...##..#....#.#..##\n\
..##........##............##...\n..........#...#.......#.......#\n\
.#...............#...#.##......\n#.##......#....#.##.#..#..#...#\n\
......###.........#...#..#....#\n....#......#...#....#....#...#.\n\
#...##...#....#......####....#.\n.................#......#......\n\
..#..........##.......##..#.##.\n.#.....#.......#...######..#..#\n\
....##.#...#...#..........#....\n.....#.......#...#.#.......###.\n\
#...#.###.....#...#.......#....\n.#.##.####....#.....#.#........\n\
.......#.....##............##..\n..#...#.#.##........#...##...#.\n\
........#...####.##..#....#...#\n#.......#...##.#......#..#...#.\n\
......#.........#..###.#.#....#\n#..##...#...#..#...#...#.....#.\n\
.#...#...#.#.................##\n#......#.....#..#.#..#......##.\n\
.......#.##...#.......#.......#\n.#.#..#..#......#....#.#...#.#.\n\
..#...#.#..#......#...#.#.#....\n........#..............#..##...\n\
.##..#..##.#....#.#..###..#..#.\n..#....#......#...#.#.#....#...\n\
...#..#..#....#..#.....##......\n.#......#...#........##........\n\
.#......#..#...##..#..#.#.#....\n.##......#.##.........#....#...\n\
....#....##..#..###.#..#......#\n....#....##..........#.#...#...\n\
..##.#.............#..#.....#..\n..#.....#....#....#.......##...\n\
.##.#....#....#...#....##.#....\n...#.#..#.###.#..#.#.......#.#.\n\
.....##.....#.......#......#...\n.#.....#..#.#.#..#........##...\n\
##.....................#.......\n..###............#........##..#\n\
.#.##.....#..#..#..#.#.......#.\n.##...................#..#..#..\n\
..#.#...#..........##..#..##...\n#......#..#..#.#..#......#..#.#\n\
.#...#....#.#.........#.....#.#\n#..........#.#....#....#.#.#.#.\n\
#.....#..........#..#....#..#..\n........#....#..##.#.#.......#.\n\
.#.......##.......#..##...#....\n...#..##..#......##.#..#.#..#..\n\
.#..#.......#..##..#......#....\n###.#.........#......#.#.......\n\
...#......#....#..##..#.#..#...\n......#..#.....#.........#....#\n\
....#..#..#..#.........##.#..#.\n......#..#..#..#....#...#..##.#\n\
......##.#..#..#.#.......#.#.##\n..#.....#...#..#....#..........\n\
.##..##.....##.......#.##.#....\n...#..#.......#..#.......#.....\n\
.........#....##..#.#....#.#...\n.....#..#...#.........#....#..#\n\
.........##.....#.#...#.###...#\n.#......####..##...#..#........\n\
.#......##....#.....#..........\n##.......##.#.......#..........\n\
.#......#.#.#.#....#........#..\n......##..##...#...#...........\n\
.#...#.#..#......#.#.#.#....#.#\n...#.........#.....#...###.....\n\
#.....##....#.##...#....#......\n.#..#...#..##.###.#.#.#...#....\n\
...#......#..#....#...#...#....\n.#..............#.....#........\n\
..##...#.....#..#.....#..#.#...\n.##...#....#.##...#.........##.\n\
..#......#...##..#.....#......#\n#.#..............#...#...#..#.#\n\
..#..#.#...........#...#.#.#...\n#..........#...#..#..##..#....#\n\
............#...#........###...\n.........#.....#.....#..#......\n\
#...#.#..##......#.#####.......\n...#........#..............#...\n\
......###.#.#.....#..#....##.#.\n.#.#.#..##....###.#..#....##...\n\
.#....#.##............##.#.....\n##...##.#......#.#.##.##...###.\n\
.......#.#........#.....#......\n....#.....#......#...#.#..#....\n\
.#.........#....#...#...#...#.#\n#.......#................#..#..\n\
.##...........#.##...##....#...\n#...#.#...###.........#.......#\n\
.#...#.........................\n#.......#...#.....##.##...##...\n\
.#.#....#.......#.#.##.#....#..\n#..#....#...#.#.##.#....#....#.\n\
.##.....#.#..#...#..#..........\n.............#...#.#..#........\n\
....#........#..#......##......\n#.....#....#.....#.......#.....\n\
........#.......##....#........\n.#.#..##.......................\n\
##..#.....#........#.....#.....\n.#......#.#...#.#..........#..#\n\
.#..#.....#..#..........#.###..\n......#.#..#.#.......#.#.....#.\n\
.#....#......#..##.............\n#...##.........#.#.#...#.....#.\n\
..#................#..#..###...\n#.....#....##.#..##......#.#.#.\n\
..#....#...#...#...............\n#................#....#...#.#..\n\
................#...#.....#.##.\n..#.#.#..#.##.......##.......##\n\
...........#......##.......###.\n...#.......##.........#.#.#.#..\n\
.#...#.#..#...#.#.....#........\n............#####......##......\n\
....###....#.##...#..#.........\n..#.#...#.......#...#...#.###..\n\
..............##..#...#....#...\n#.#..##...#....##.........#....\n\
..#...#.....#...........#...#..\n#.#..###..#.#..#........#..#.#.\n\
...###...##...#...#.#.........#\n..#........#.....#.#.#.......#.\n\
...#..#..........#.....#...#...\n....#..#.....#....##....#.##...\n\
.....##..#...#.#..##...#...##.#\n...........###...##....#.......\n\
##..#.#..#..#...#....##..#..#..\n##...#.#......##.#..#...#....#.\n\
.#.......#...........#...#.....\n#...#....#.......#...#.##......\n\
.........#.......#...#.#...#...\n.......##.#..................#.\n\
........#..#.#......#.....#....\n.....#.#.#.#....##...#.###.....\n\
#.#.........#..#.#.#.#.#.......\n.............#....#.......###..\n\
.#.##....#....##.........####..\n...........###.#...............\n\
#.........##.#.#..#.....##.###.\n.#.#.....#.#...#.....##...#...#\n\
#....#...#.........#.#.......#.\n.....#.###..#....#...##..#...#.\n\
#........#....#.#..#....#.#....\n#.#..##......#.........#.#.....\n\
##..#.....#......###....#....#.\n#.#.####..#.#.#......##...#..#.\n\
....#.....#.#.#.#.....#........\n..##..........#......#.#.#..#..\n\
.#...##.##.........#.........##\n..#.#.#..........#..#..#......#\n\
###..###..#...#................\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8170878445567017`*^9, 3.817087868686133*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d5755bb3-5832-40d2-9f94-6ec9b635ed7b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", "=", 
         RowBox[{"input", "[", 
          RowBox[{"[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"StringPart", "[", 
        RowBox[{"s", ",", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
            RowBox[{"StringLength", "@", "s"}]}], "]"}], "+", "1"}]}], 
        "]"}]}], "]"}], "&"}], "/@", 
    RowBox[{"NestWhileList", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "+", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}]}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "<", 
        RowBox[{"Length", "[", "input", "]"}]}], "&"}]}], "]"}]}], ",", 
   "\"\<#\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.8170878719743996`*^9, 3.817088206405538*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"fd7dfeb8-62b1-4862-9cc6-34bc479e7ac8"],

Cell[BoxData["195"], "Output",
 CellChangeTimes->{
  3.817087874225767*^9, {3.817087971540554*^9, 3.8170879981300817`*^9}, {
   3.8170881692358055`*^9, 3.817088207044955*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"d7911574-9d31-485a-b9d0-a9b1ec8e7f9b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2", "Section",
 CellChangeTimes->{{3.817071905144342*^9, 
  3.8170719182231984`*^9}},ExpressionUUID->"808325e7-a9dc-4bf8-947d-\
a2f1c3196b19"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", "slope", "}"}], ",", 
     RowBox[{"Count", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"s", "=", 
             RowBox[{"input", "[", 
              RowBox[{"[", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"StringPart", "[", 
            RowBox[{"s", ",", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#1", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], ",", 
                RowBox[{"StringLength", "@", "s"}]}], "]"}], "+", "1"}]}], 
            "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"NestWhileList", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "+", "slope"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<", 
            RowBox[{"Length", "[", "input", "]"}]}], "&"}]}], "]"}]}], ",", 
       "\"\<#\>\""}], "]"}]}], "]"}], "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "}"}]}], "//", 
  RowBox[{
   RowBox[{"Times", "@@", "#"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.8170882620743985`*^9, 3.8170883943044825`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"00ede5d4-16a1-44d4-932b-30f51d75f0ab"],

Cell[BoxData["3772314000"], "Output",
 CellChangeTimes->{3.8170883231131744`*^9, 3.8170883950341334`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"f6f3ecd3-ca29-4669-8c6b-ef96603544d3"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{864.5, 380.},
WindowMargins->{{Automatic, -105.5}, {19.5, Automatic}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (2020\:5e746\:67089\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5da71b72-0d60-4d5f-9c2d-e79f21a303eb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 3, 67, "Section",ExpressionUUID->"e7ff7d93-d355-41b5-83b6-78042f1ddb9f"],
Cell[754, 27, 11251, 168, 6268, "Input",ExpressionUUID->"d5755bb3-5832-40d2-9f94-6ec9b635ed7b"],
Cell[CellGroupData[{
Cell[12030, 199, 1273, 38, 48, "Input",ExpressionUUID->"fd7dfeb8-62b1-4862-9cc6-34bc479e7ac8"],
Cell[13306, 239, 253, 4, 32, "Output",ExpressionUUID->"d7911574-9d31-485a-b9d0-a9b1ec8e7f9b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[13608, 249, 148, 3, 67, "Section",ExpressionUUID->"808325e7-a9dc-4bf8-947d-a2f1c3196b19"],
Cell[CellGroupData[{
Cell[13781, 256, 1885, 55, 87, "Input",ExpressionUUID->"00ede5d4-16a1-44d4-932b-30f51d75f0ab"],
Cell[15669, 313, 183, 2, 32, "Output",ExpressionUUID->"f6f3ecd3-ca29-4669-8c6b-ef96603544d3"]
}, Open  ]]
}, Open  ]]
}
]
*)

